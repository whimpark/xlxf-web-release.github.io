import{j as v,O as y,P as E,p as w,q as S}from"./vendor-d18883b8b0cf97071b848f7ddd5e8c7d-1b148cd2.js";import{r as k,u as B}from"./vendor-bf3e2924dcba1c52da01b5eda1111b2b-af91f3df.js";import{ab as u,r as _,o as N,c as j,a as d,a9 as e,b1 as r,a8 as m}from"./vendor-e1f92d6dd78b37156c9468a675d2253f-74c9097a.js";import{_ as D}from"./vendor-dd2349d317d74ca7a80b7b9367c72a84-bdf7e2bf.js";import"./vendor-61fb611e6bd6e41dfb66cf838f1d32c0-d9f04f96.js";import"./vendor-eb6677555573f02990f41d7923105813-64b458c9.js";import"./vendor-12e7d3ab8f59885f55dffca19f4bf54f-ea36b144.js";import"./vendor-951c1f757a9f918f0624cd5cb90b890d-6abd67e7.js";import"./vendor-5a93269d3ee5ba7d2c0a8f64966e32cf-ed0dc00a.js";import"./vendor-13d3464b13e18d062812c818b64e1045-0a5b1c59.js";import"./vendor-50e4dafc45a421887af307e4920b9da2-34ea3559.js";import"./vendor-f3a119a8db2aef7c107dd2777fa080f1-dee29e8b.js";import"./vendor-a44dcf2a8879c0219241de5805670ddc-43a4208a.js";import"./vendor-28ee9a8430f9e12788896ab32ee5ca81-c75af06c.js";import"./vendor-f941badbb0a8a7d3b8ec47242556b76c-1d60d822.js";import"./vendor-fd49668b7919b44095b834dc15d7330f-ed76fb12.js";import"./vendor-2d991217d9735d01291a78c61e1d6036-71359fe8.js";const C={class:"container"},T={class:"handle-box"},V=u({name:"import"}),q=u({...V,setup(I){const c=_([]);(()=>{c.value=[{id:1,name:"小明",sno:"S001",class:"一班",age:"10",sex:"男"},{id:2,name:"小红",sno:"S002",class:"一班",age:"9",sex:"女"}]})();const i=_([]),f=async o=>(i.value=await b(o),!0),b=o=>new Promise(function(a,s){const n=new FileReader;n.onload=function(p){const t=p.target.result;let l=k(t,{type:"binary"});const x=l.SheetNames[0],g=B.sheet_to_json(l.Sheets[x]);a(g)},n.readAsBinaryString(o)}),h=async()=>{const o=i.value.map((a,s)=>({id:s,name:a.姓名,sno:a.学号,class:a.班级,age:a.年龄,sex:a.性别}));c.value.push(...o)};return(o,a)=>{const s=v,n=y,p=E,t=w,l=S;return N(),j("div",null,[d("div",C,[d("div",T,[e(n,{action:"#",limit:1,accept:".xlsx, .xls","show-file-list":!1,"before-upload":f,"http-request":h},{default:r(()=>[e(s,{class:"mr10",type:"success"},{default:r(()=>[m("批量导入")]),_:1})]),_:1}),e(p,{href:"/template.xlsx",target:"_blank"},{default:r(()=>[m("下载模板")]),_:1})]),e(l,{data:c.value,border:"",class:"table","header-cell-class-name":"table-header"},{default:r(()=>[e(t,{prop:"id",label:"ID",width:"55",align:"center"}),e(t,{prop:"name",label:"姓名"}),e(t,{prop:"sno",label:"学号"}),e(t,{prop:"class",label:"班级"}),e(t,{prop:"age",label:"年龄"}),e(t,{prop:"sex",label:"性别"})]),_:1},8,["data"])])])}}});const $=D(q,[["__scopeId","data-v-5feda0af"]]);export{$ as default};
